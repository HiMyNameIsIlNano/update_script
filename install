#!/bin/sh

default_dir=${HOME}/.local/scripts
cmd="(sleep 90 && ${default_dir}/update_wrapper) &"

mkdir -p ${default_dir}

cp update ${default_dir}
chmod +x ${default_dir}/update
cp update.config ${default_dir}

cp update_world ${default_dir}
chmod +x ${default_dir}/update_world
cp update_world.config ${default_dir}

cp update_pkg ${default_dir}
chmod +x ${default_dir}/update_pkg

cp update_wrapper ${default_dir}

today=$(date '+%s')

# Configure the two log files if they do not already exist 
if [ ! -f ${default_dir}/update_ports.log ]; then 
	echo ${today} > ${default_dir}/update_ports.log
fi

if [ ! -f ${default_dir}/update_world.log ]; then 
	echo ${today} > ${default_dir}/update_world.log
fi

if [ -d "${HOME}/.config/openbox" ]; then  
	if grep -Fxq "${cmd}" ${HOME}/.config/openbox/autostart.sh
	then
		echo "No need to add update_wrapper to autostart.sh as it is already present"
	else
		echo ${cmd} >> ${HOME}/.config/openbox/autostart.sh
	fi
fi
